# Maintainer: Danct12 <danct12@disroot.org>
pkgname=callaudiod
pkgver=0.1.3+12+g4a92e48
_commit=4a92e48fc1eee40088d802eead4c2445b0cebc02
pkgrel=1
pkgdesc="Call audio routing daemon"
url="https://gitlab.com/mobian1/callaudiod"
license=('GPL3')
arch=('x86_64' 'armv7h' 'aarch64')
depends=('alsa-lib' 'glib2' 'libpulse')
makedepends=('meson')
source=("git+https://gitlab.com/mobian1/${pkgname}.git#commit=${_commit}")
md5sums=('SKIP')

pkgver() {
  cd $pkgname
  git describe --tags | sed 's/^v//;s/-/+/g'
}

prepare() {
  cd "$srcdir/$pkgname"

  local src
  for src in "${source[@]}"; do
      src="${src%%::*}"
      src="${src##*/}"
      [[ $src = *.patch ]] || continue
  done
}

build() {
    arch-meson $pkgname build \
    -D gtk_doc=true
    ninja -C build
}

package() {
    DESTDIR="$pkgdir" ninja -C build install
}
